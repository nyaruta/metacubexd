var Ze=Object.defineProperty;var Je=(t,r,e)=>r in t?Ze(t,r,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[r]=e;var oe=(t,r,e)=>Je(t,typeof r!="symbol"?r+"":r,e);import{n as je,J as Re,d as c,y as q,S as Se,i as b,K as B,L as ae,M as Le,P as Qe,p as G,N as L,t as E,O as ze,Q as Ke,o as ve,m as ie,c as _e,w as W,G as X,u as be,R as Ge,B as Y,T as et,U as tt,V as rt,F as Q,W as at,X as le,Y as Ve,I as Ce,Z as qe,_ as Be,z as He,$ as De,a0 as $e,a1 as nt,b as ot,v as st,a2 as lt,a3 as T,a4 as it,a5 as Pe,a6 as Fe,A as ue,a7 as ct,a8 as Te,a9 as Me,q as dt,aa as se,ab as ut,ac as gt,ad as vt,ae as bt,af as pe,ag as Ae,ah as Ee,ai as ft,aj as mt,ak as pt,al as ht,am as yt,an as xt,j as It}from"./index-o5lPLXoZ.js";import{c as Ct,g as $t,a as St,b as _t,d as Dt,e as wt,f as ge,r as Ot}from"./index-Bt-xnT5v.js";import{z as he,c as Pt,v as Ft}from"./index-DLW1Uto8.js";import{C as ye}from"./ConfigTitle-Ct7fRULr.js";import{f as Tt}from"./global-hC0rTsfE.js";var Mt=E("<div>"),fe=class{constructor(t){oe(this,"x");oe(this,"y");oe(this,"width");oe(this,"height");this.x=Math.floor(t.x),this.y=Math.floor(t.y),this.width=Math.floor(t.width),this.height=Math.floor(t.height)}get rect(){return{x:this.x,y:this.y,width:this.width,height:this.height}}get left(){return this.x}get top(){return this.y}get right(){return this.x+this.width}get bottom(){return this.y+this.height}get center(){return{x:this.x+this.width*.5,y:this.y+this.height*.5}}get corners(){return{topLeft:{x:this.left,y:this.top},topRight:{x:this.right,y:this.top},bottomRight:{x:this.left,y:this.bottom},bottomLeft:{x:this.right,y:this.bottom}}}},ne=t=>{let r=new fe(t.getBoundingClientRect());const{transform:e}=getComputedStyle(t);return e&&(r=At(r,e)),r},At=(t,r)=>{let e,a;if(r.startsWith("matrix3d(")){const i=r.slice(9,-1).split(/, /);e=+i[12],a=+i[13]}else if(r.startsWith("matrix(")){const i=r.slice(7,-1).split(/, /);e=+i[4],a=+i[5]}else e=0,a=0;return new fe({...t,x:t.x-e,y:t.y-a})},V=()=>({x:0,y:0}),we=(t,r)=>t.x===r.x&&t.y===r.y,xe=(t,r)=>new fe({...t,x:t.x+r.x,y:t.y+r.y}),Et=(t,r)=>Math.sqrt(Math.pow(t.x-r.x,2)+Math.pow(t.y-r.y,2)),kt=(t,r)=>{const e=Math.max(t.top,r.top),a=Math.max(t.left,r.left),i=Math.min(t.right,r.right),p=Math.min(t.bottom,r.bottom),v=i-a,u=p-e;if(a<i&&e<p){const l=t.width*t.height,h=r.width*r.height,g=v*u;return g/(l+h-g)}return 0},Ie=(t,r)=>t.x===r.x&&t.y===r.y&&t.width===r.width&&t.height===r.height,Nt=(t,r,e)=>{const a=t.transformed.center,i={distance:1/0,droppable:null};for(const p of r){const v=Et(a,p.layout.center);v<i.distance?(i.distance=v,i.droppable=p):v===i.distance&&p.id===e.activeDroppableId&&(i.droppable=p)}return i.droppable},jt=(t,r,e)=>{const a=t.transformed,i={ratio:0,droppable:null};for(const p of r){const v=kt(a,p.layout);v>i.ratio?(i.ratio=v,i.droppable=p):v>0&&v===i.ratio&&p.id===e.activeDroppableId&&(i.droppable=p)}return i.droppable},Ue=ze(),Rt=t=>{const r=je({collisionDetector:jt},t),[e,a]=Re({draggables:{},droppables:{},sensors:{},active:{draggableId:null,get draggable(){return e.active.draggableId!==null?e.draggables[e.active.draggableId]:null},droppableId:null,get droppable(){return e.active.droppableId!==null?e.droppables[e.active.droppableId]:null},sensorId:null,get sensor(){return e.active.sensorId!==null?e.sensors[e.active.sensorId]:null},overlay:null}}),i=(n,d,m)=>{n.substring(0,n.length-1),L(()=>e[n][d])&&a(n,d,"transformers",m.id,m)},p=(n,d,m)=>{n.substring(0,n.length-1),L(()=>e[n][d])&&L(()=>e[n][d].transformers[m])&&a(n,d,"transformers",m,void 0)},v=({id:n,node:d,layout:m,data:k})=>{const y=e.draggables[n],I={id:n,node:d,layout:m,data:k,_pendingCleanup:!1};let s;if(!y)Object.defineProperties(I,{transformers:{enumerable:!0,configurable:!0,writable:!0,value:{}},transform:{enumerable:!0,configurable:!0,get:()=>{if(e.active.overlay)return V();const C=Object.values(e.draggables[n].transformers);return C.sort((x,R)=>x.order-R.order),C.reduce((x,R)=>R.callback(x),V())}},transformed:{enumerable:!0,configurable:!0,get:()=>xe(e.draggables[n].layout,e.draggables[n].transform)}});else if(e.active.draggableId===n&&!e.active.overlay){const C={x:y.layout.x-m.x,y:y.layout.y-m.y},x="addDraggable-existing-offset",R=y.transformers[x],K=R?R.callback(C):C;s={id:x,order:100,callback:j=>({x:j.x+K.x,y:j.y+K.y})},re(()=>p("draggables",n,x))}X(()=>{a("draggables",n,I),s&&i("draggables",n,s)}),e.active.draggable&&A()},u=n=>{L(()=>e.draggables[n])&&(a("draggables",n,"_pendingCleanup",!0),queueMicrotask(()=>l(n)))},l=n=>{var d;if((d=e.draggables[n])!=null&&d._pendingCleanup){const m=e.active.draggableId===n;X(()=>{m&&a("active","draggableId",null),a("draggables",n,void 0)})}},h=({id:n,node:d,layout:m,data:k})=>{const y=e.droppables[n],I={id:n,node:d,layout:m,data:k,_pendingCleanup:!1};y||Object.defineProperties(I,{transformers:{enumerable:!0,configurable:!0,writable:!0,value:{}},transform:{enumerable:!0,configurable:!0,get:()=>{const s=Object.values(e.droppables[n].transformers);return s.sort((C,x)=>C.order-x.order),s.reduce((C,x)=>x.callback(C),V())}},transformed:{enumerable:!0,configurable:!0,get:()=>xe(e.droppables[n].layout,e.droppables[n].transform)}}),a("droppables",n,I),e.active.draggable&&A()},g=n=>{L(()=>e.droppables[n])&&(a("droppables",n,"_pendingCleanup",!0),queueMicrotask(()=>$(n)))},$=n=>{var d;if((d=e.droppables[n])!=null&&d._pendingCleanup){const m=e.active.droppableId===n;X(()=>{m&&a("active","droppableId",null),a("droppables",n,void 0)})}},_=({id:n,activators:d})=>{a("sensors",n,{id:n,activators:d,coordinates:{origin:{x:0,y:0},current:{x:0,y:0},get delta(){return{x:e.sensors[n].coordinates.current.x-e.sensors[n].coordinates.origin.x,y:e.sensors[n].coordinates.current.y-e.sensors[n].coordinates.origin.y}}}})},F=n=>{if(!L(()=>e.sensors[n]))return;const d=e.active.sensorId===n;X(()=>{d&&a("active","sensorId",null),a("sensors",n,void 0)})},S=({node:n,layout:d})=>{const m=e.active.overlay,k={node:n,layout:d};m||Object.defineProperties(k,{id:{enumerable:!0,configurable:!0,get:()=>{var y;return(y=e.active.draggable)==null?void 0:y.id}},data:{enumerable:!0,configurable:!0,get:()=>{var y;return(y=e.active.draggable)==null?void 0:y.data}},transformers:{enumerable:!0,configurable:!0,get:()=>Object.fromEntries(Object.entries(e.active.draggable?e.active.draggable.transformers:{}).filter(([y])=>y!=="addDraggable-existing-offset"))},transform:{enumerable:!0,configurable:!0,get:()=>{const y=Object.values(e.active.overlay?e.active.overlay.transformers:[]);return y.sort((I,s)=>I.order-s.order),y.reduce((I,s)=>s.callback(I),V())}},transformed:{enumerable:!0,configurable:!0,get:()=>e.active.overlay?xe(e.active.overlay.layout,e.active.overlay.transform):new fe({x:0,y:0,width:0,height:0})}}),a("active","overlay",k)},O=()=>a("active","overlay",null),f=(n,d)=>{X(()=>{a("sensors",n,"coordinates",{origin:{...d},current:{...d}}),a("active","sensorId",n)})},w=n=>{const d=e.active.sensorId;d&&a("sensors",d,"coordinates","current",{...n})},N=()=>a("active","sensorId",null),M=(n,d)=>{const m={};for(const y of Object.values(e.sensors))if(y)for(const[I,s]of Object.entries(y.activators))m[I]??(m[I]=[]),m[I].push({sensor:y,activator:s});const k={};for(const y in m){let I=y;d&&(I=`on${y}`),k[I]=s=>{for(const{activator:C}of m[y]){if(e.active.sensor)break;C(s,n)}}}return k},A=()=>{let n=!1;const d=Object.values(e.draggables),m=Object.values(e.droppables),k=e.active.overlay;return X(()=>{const y=new WeakMap;for(const I of d)if(I){const s=I.layout;y.has(I.node)||y.set(I.node,ne(I.node));const C=y.get(I.node);Ie(s,C)||(a("draggables",I.id,"layout",C),n=!0)}for(const I of m)if(I){const s=I.layout;y.has(I.node)||y.set(I.node,ne(I.node));const C=y.get(I.node);Ie(s,C)||(a("droppables",I.id,"layout",C),n=!0)}if(k){const I=k.layout,s=ne(k.node);Ie(I,s)||(a("active","overlay","layout",s),n=!0)}}),n},P=()=>{const n=e.active.overlay??e.active.draggable;if(n){const d=r.collisionDetector(n,Object.values(e.droppables),{activeDroppableId:e.active.droppableId}),m=d?d.id:null;e.active.droppableId!==m&&a("active","droppableId",m)}},H=n=>{const d={id:"sensorMove",order:0,callback:m=>e.active.sensor?{x:m.x+e.active.sensor.coordinates.delta.x,y:m.y+e.active.sensor.coordinates.delta.y}:m};A(),X(()=>{a("active","draggableId",n),i("draggables",n,d)}),P()},te=()=>{const n=L(()=>e.active.draggableId);X(()=>{n!==null&&p("draggables",n,"sensorMove"),a("active",["draggableId","droppableId"],null)}),A()},o=n=>{G(()=>{const d=e.active.draggable;d&&L(()=>n({draggable:d}))})},D=n=>{G(()=>{const d=e.active.draggable;if(d){const m=L(()=>e.active.overlay);Object.values(m?m.transform:d.transform),L(()=>n({draggable:d,overlay:m}))}})},Z=n=>{G(()=>{const d=e.active.draggable,m=e.active.droppable;d&&L(()=>n({draggable:d,droppable:m,overlay:e.active.overlay}))})},re=n=>{G(({previousDraggable:d,previousDroppable:m,previousOverlay:k})=>{const y=e.active.draggable,I=y?e.active.droppable:null,s=y?e.active.overlay:null;return!y&&d&&L(()=>n({draggable:d,droppable:m,overlay:k})),{previousDraggable:y,previousDroppable:I,previousOverlay:s}},{previousDraggable:null,previousDroppable:null,previousOverlay:null})};D(()=>P()),r.onDragStart&&o(r.onDragStart),r.onDragMove&&D(r.onDragMove),r.onDragOver&&Z(r.onDragOver),r.onDragEnd&&re(r.onDragEnd);const me=[e,{addTransformer:i,removeTransformer:p,addDraggable:v,removeDraggable:u,addDroppable:h,removeDroppable:g,addSensor:_,removeSensor:F,setOverlay:S,clearOverlay:O,recomputeLayouts:A,detectCollisions:P,draggableActivators:M,sensorStart:f,sensorMove:w,sensorEnd:N,dragStart:H,dragEnd:te,onDragStart:o,onDragMove:D,onDragOver:Z,onDragEnd:re}];return c(Ue.Provider,{value:me,get children(){return r.children}})},ee=()=>Ke(Ue)||null,Lt=(t="pointer-sensor")=>{const[r,{addSensor:e,removeSensor:a,sensorStart:i,sensorMove:p,sensorEnd:v,dragStart:u,dragEnd:l}]=ee(),h=250,g=10;ve(()=>{e({id:t,activators:{pointerdown:O}})}),ie(()=>{a(t)});const $=()=>r.active.sensorId===t,_={x:0,y:0};let F=null,S=null;const O=(P,H)=>{P.button===0&&(document.addEventListener("pointermove",N),document.addEventListener("pointerup",M),S=H,_.x=P.clientX,_.y=P.clientY,F=window.setTimeout(w,h))},f=()=>{F&&(clearTimeout(F),F=null),document.removeEventListener("pointermove",N),document.removeEventListener("pointerup",M),document.removeEventListener("selectionchange",A)},w=()=>{r.active.sensor?$()||f():(i(t,_),u(S),A(),document.addEventListener("selectionchange",A))},N=P=>{const H={x:P.clientX,y:P.clientY};if(!r.active.sensor){const te={x:H.x-_.x,y:H.y-_.y};Math.sqrt(te.x**2+te.y**2)>g&&w()}$()&&(P.preventDefault(),p(H))},M=P=>{f(),$()&&(P.preventDefault(),l(),v())},A=()=>{var P;(P=window.getSelection())==null||P.removeAllRanges()}},zt=t=>(Lt(),q(()=>t.children)),ce=t=>({transform:`translate3d(${t.x}px, ${t.y}px, 0)`}),Kt=(t,r={})=>{const[e,{addDraggable:a,removeDraggable:i,draggableActivators:p}]=ee(),[v,u]=W(null);ve(()=>{const $=v();$&&a({id:t,node:$,layout:ne($),data:r})}),ie(()=>i(t));const l=()=>e.active.draggableId===t,h=()=>{var $;return(($=e.draggables[t])==null?void 0:$.transform)||V()};return Object.defineProperties(($,_)=>{const F=_?_():{};G(()=>{const S=v(),O=p(t);if(S)for(const f in O)S.addEventListener(f,O[f]);ie(()=>{if(S)for(const f in O)S.removeEventListener(f,O[f])})}),u($),F.skipTransform||G(()=>{const S=h();if(we(S,V()))$.style.removeProperty("transform");else{const O=ce(h());$.style.setProperty("transform",O.transform??null)}})},{ref:{enumerable:!0,value:u},isActiveDraggable:{enumerable:!0,get:l},dragActivators:{enumerable:!0,get:()=>p(t,!0)},transform:{enumerable:!0,get:h}})},Gt=(t,r={})=>{const[e,{addDroppable:a,removeDroppable:i}]=ee(),[p,v]=W(null);ve(()=>{const g=p();g&&a({id:t,node:g,layout:ne(g),data:r})}),ie(()=>i(t));const u=()=>e.active.droppableId===t,l=()=>{var g;return((g=e.droppables[t])==null?void 0:g.transform)||V()};return Object.defineProperties((g,$)=>{const _=$?$():{};v(g),_.skipTransform||G(()=>{const F=l();if(we(F,V()))g.style.removeProperty("transform");else{const S=ce(l());g.style.setProperty("transform",S.transform??null)}})},{ref:{enumerable:!0,value:v},isActiveDroppable:{enumerable:!0,get:u},transform:{enumerable:!0,get:l}})},Vt=t=>{const[r,{onDragStart:e,onDragEnd:a,setOverlay:i,clearOverlay:p}]=ee();let v;e(({draggable:l})=>{i({node:l.node,layout:l.layout}),queueMicrotask(()=>{if(v){const h=ne(v),g={x:(l.layout.width-h.width)/2,y:(l.layout.height-h.height)/2};h.x+=g.x,h.y+=g.y,i({node:v,layout:h})}})}),a(()=>queueMicrotask(p));const u=()=>{const l=r.active.overlay,h=r.active.draggable;return!l||!h?{}:{position:"fixed",transition:"transform 0s",top:`${l.layout.top}px`,left:`${l.layout.left}px`,"min-width":`${h.layout.width}px`,"min-height":`${h.layout.height}px`,...ce(l.transform),...t.style}};return c(Qe,{get mount(){return document.body},get children(){return c(Se,{get when(){return r.active.draggable},get children(){var l=Mt(),h=v;return typeof h=="function"?_e(h,l):v=l,b(l,(()=>{var g=q(()=>typeof t.children=="function");return()=>g()?t.children(r.active.draggable):t.children})()),B(g=>{var $=t.class,_=u();return $!==g.e&&ae(l,g.e=$),g.t=Le(l,_,g.t),g},{e:void 0,t:void 0}),l}})}})},qt=(t,r,e)=>{const a=t.slice();return a.splice(e,0,...a.splice(r,1)),a},We=ze(),Bt=t=>{const[r]=ee(),[e,a]=Re({initialIds:[],sortedIds:[]}),i=u=>u>=0&&u<e.initialIds.length;G(()=>{a("initialIds",[...t.ids]),a("sortedIds",[...t.ids])}),G(()=>{r.active.draggableId&&r.active.droppableId?L(()=>{const u=e.sortedIds.indexOf(r.active.draggableId),l=e.initialIds.indexOf(r.active.droppableId);if(!i(u)||!i(l))a("sortedIds",[...t.ids]);else if(u!==l){const h=qt(e.sortedIds,u,l);a("sortedIds",h)}}):a("sortedIds",[...t.ids])});const v=[e,{}];return c(We.Provider,{value:v,get children(){return t.children}})},Ht=()=>Ke(We)||null,Ut=(t,r)=>e=>{t(e),r(e)},Wt=(t,r={})=>{const[e,{addTransformer:a,removeTransformer:i}]=ee(),[p]=Ht(),v=Kt(t,r),u=Gt(t,r),l=Ut(v.ref,u.ref),h=()=>p.initialIds.indexOf(t),g=()=>p.sortedIds.indexOf(t),$=f=>{var w;return((w=e.droppables[f])==null?void 0:w.layout)||null},_=()=>{const f=V(),w=h(),N=g();if(N!==w){const M=$(t),A=$(p.initialIds[N]);M&&A&&(f.x=A.x-M.x,f.y=A.y-M.y)}return f},F={id:"sortableOffset",order:100,callback:f=>{const w=_();return{x:f.x+w.x,y:f.y+w.y}}};ve(()=>a("droppables",t,F)),ie(()=>i("droppables",t,F.id));const S=()=>{var f,w;return(t===e.active.draggableId&&!e.active.overlay?(f=e.draggables[t])==null?void 0:f.transform:(w=e.droppables[t])==null?void 0:w.transform)||V()};return Object.defineProperties(f=>{v(f,()=>({skipTransform:!0})),u(f,()=>({skipTransform:!0})),G(()=>{const w=S();if(we(w,V()))f.style.removeProperty("transform");else{const N=ce(S());f.style.setProperty("transform",N.transform??null)}})},{ref:{enumerable:!0,value:l},transform:{enumerable:!0,get:S},isActiveDraggable:{enumerable:!0,get:()=>v.isActiveDraggable},dragActivators:{enumerable:!0,get:()=>v.dragActivators},isActiveDroppable:{enumerable:!0,get:()=>u.isActiveDroppable}})},Yt=E('<form><div class="join flex"><select name=sourceIP class="join-item select select-bordered"><option></option></select><input name=tagName class="input join-item input-bordered min-w-0 flex-1"placeholder=name>'),Xt=E("<option class=badge>"),Zt=E('<div><div class="flex justify-between py-2"><div class="flex items-center gap-2"><span></span></div><input type=checkbox class=toggle>'),Jt=E("<div>"),Qt=E('<div class="flex flex-col gap-4"><div><select class="select select-bordered w-full"></select></div><div><div class="flex flex-col gap-4"><div class="flex flex-col gap-2"></div></div></div><div>'),er=E("<option>"),tr=E('<div class="badge badge-primary w-full items-center justify-between gap-2 py-4"><span class=truncate> (<!>)');const rr=()=>{const t=he.object({tagName:he.string().min(1),sourceIP:he.string().min(1)}),[r]=be(),{form:e,reset:a}=Pt({extend:Ft({schema:t}),onSubmit:({tagName:i,sourceIP:p})=>{Ve(v=>v.some(u=>u.tagName===i||u.sourceIP===p)?v:[...v,{tagName:i,sourceIP:p}]),a()}});return(()=>{var i=Yt(),p=i.firstChild,v=p.firstChild;return v.firstChild,v.nextSibling,_e(e,i,()=>e),b(v,c($e,{get each(){return He.uniq(De().map(({metadata:{sourceIP:u}})=>u)).sort().filter(u=>!le().some(({sourceIP:l})=>l===u))},children:u=>(()=>{var l=Xt();return b(l,u),B(()=>l.value=u()),l})()}),null),b(p,c(Y,{type:"submit",class:"join-item",get children(){return r("tag")}}),null),i})()},ar=t=>{const[r]=be(),[e,a]=W(null),i=({draggable:u})=>a(u.id),p=({draggable:u,droppable:l})=>{if(u&&l){const h=t.order,g=h.indexOf(u.id),$=h.indexOf(l.id);if(g!==$){const _=h.slice();_.splice($,0,..._.splice(g,1)),t.onOrderChange(_)}}},v=({key:u})=>{const l=Wt(u),[h]=ee();return(()=>{var g=Zt(),$=g.firstChild,_=$.firstChild,F=_.firstChild,S=_.nextSibling,O=l.ref;return typeof O=="function"?_e(O,g):l.ref=g,b(_,c(Y,je({class:"btn-ghost btn-sm cursor-grab",get icon(){return c(nt,{size:24})}},()=>l.dragActivators)),F),b(F,()=>r(u)),S.addEventListener("change",f=>{t.onVisibleChange({...t.visible,[u]:f.target.checked})}),B(f=>{var w=!!l.isActiveDraggable,N=!!h.active.draggable,M=ce(l.transform);return w!==f.e&&g.classList.toggle("opacity-25",f.e=w),N!==f.t&&g.classList.toggle("transition-transform",f.t=N),f.a=Le(g,M,f.a),f},{e:void 0,t:void 0,a:void 0}),B(()=>S.checked=t.visible[u]),g})()};return c(Be,{ref:u=>{var l;return(l=t.ref)==null?void 0:l.call(t,u)},get icon(){return c(Ge,{size:24})},get title(){return r("connectionsSettings")},get action(){return c(Y,{class:"btn-neutral btn-sm",onClick:()=>{t.onOrderChange(et),t.onVisibleChange(tt)},get children(){return r("reset")}})},get children(){var u=Qt(),l=u.firstChild,h=l.firstChild,g=l.nextSibling,$=g.firstChild,_=$.firstChild,F=g.nextSibling;return b(l,c(ye,{withDivider:!0,get children(){return r("tableSize")}}),h),h.addEventListener("change",S=>rt(S.target.value)),b(h,c(Q,{get each(){return Object.values(at)},children:S=>(()=>{var O=er();return O.value=S,b(O,()=>r(S)),O})()})),b(g,c(ye,{withDivider:!0,get children(){return r("tagClientSourceIPWithName")}}),$),b($,c(rr,{}),_),b(_,c(Q,{get each(){return le()},children:({tagName:S,sourceIP:O})=>(()=>{var f=tr(),w=f.firstChild,N=w.firstChild,M=N.nextSibling;return M.nextSibling,b(w,S,N),b(w,O,M),b(f,c(Y,{class:"btn-circle btn-ghost btn-xs",onClick:()=>Ve(A=>A.filter(P=>P.tagName!==S)),get icon(){return c(Ce,{size:12})}}),null),f})()})),b(F,c(ye,{withDivider:!0,get children(){return r("sort")}}),null),b(F,c(Rt,{onDragStart:i,onDragEnd:p,collisionDetector:Nt,get children(){return[c(zt,{}),c(Bt,{get ids(){return t.order},get children(){return c(Q,{get each(){return t.order},children:S=>c(v,{key:S})})}}),c(Vt,{get children(){return c(Se,{get when(){return e()},get children(){var S=Jt();return b(S,()=>r(e())),S}})}})]}}),null),B(()=>h.value=qe()),u}})};var nr=E("<pre><code>");const or=t=>{const[r]=be();return c(Be,{ref:e=>{var a;return(a=t.ref)==null?void 0:a.call(t,e)},get icon(){return c(Ge,{size:24})},get title(){return r("connectionsDetails")},get children(){return c(Se,{get when(){return t.selectedConnectionID},get children(){var e=nr(),a=e.firstChild;return b(a,()=>JSON.stringify(De().find(({id:i})=>i===t.selectedConnectionID),null,2)),e}})}})};var sr=async t=>{typeof t=="string"?await navigator.clipboard.writeText(t):await navigator.clipboard.write(t)},ke=E('<div class="flex h-4 items-center">'),lr=E('<div class="flex h-full flex-col gap-2"><div class="flex w-full flex-wrap items-center gap-2"><div class="flex items-center gap-2"><div class="tabs-boxed tabs gap-2"></div><select class="select select-bordered select-primary select-sm w-full max-w-full flex-1 sm:select-md"><option value=""></option></select></div><div class="join flex flex-1 items-center md:flex-1"><input type=search class="input input-sm join-item input-primary min-w-0 flex-1 sm:input-md"></div></div><div class="overflow-x-auto whitespace-nowrap rounded-md bg-base-300"><table><thead class="sticky top-0 z-10 h-8"></thead><tbody>'),ir=E('<button><span></span><div class="badge badge-sm">'),cr=E("<option>"),dr=E("<tr>"),ur=E("<th class=bg-base-200><div><div>"),gr=E("<button class=cursor-pointer>"),vr=E('<tr class="hover:!bg-primary hover:text-primary-content">'),br=E("<td class=py-2>"),fr=E("<button><div></div><div></div><div>(<!>)");const Ne=(t,r,e,a)=>{const i=Ot(t.getValue(r),e);return a({itemRank:i}),i.passed},Cr=()=>{const t=ot();if(!st())return t("/setup",{replace:!0}),null;let r,e;const[a]=be(),[i,p]=W(0),{activeConnections:v,closedConnections:u,paused:l,setPaused:h}=lt(),[g,$]=W(""),[_,F]=W(),S=[{header:()=>a("details"),enableGrouping:!1,enableSorting:!1,enableColumnFilter:!1,enableGlobalFilter:!1,accessorKey:T.Details,cell:({row:o})=>(()=>{var D=ke();return b(D,c(Y,{class:"btn-circle btn-xs",onClick:()=>{F(o.original.id),e==null||e.showModal()},get icon(){return c(it,{size:"16"})}})),D})()},{header:()=>a("close"),enableGrouping:!1,enableSorting:!1,enableColumnFilter:!1,enableGlobalFilter:!1,accessorKey:T.Close,cell:({row:o})=>(()=>{var D=ke();return b(D,c(Y,{class:"btn-circle btn-xs",onClick:()=>Pe(o.original.id),get icon(){return c(Ce,{size:"16"})}})),D})()},{header:()=>a("ID"),enableGrouping:!1,accessorKey:T.ID,accessorFn:o=>o.id},{header:()=>a("type"),accessorKey:T.Type,accessorFn:o=>`${o.metadata.type}(${o.metadata.network})`},{header:()=>a("process"),accessorKey:T.Process,accessorFn:o=>o.metadata.process||o.metadata.processPath.replace(/^.*[/\\](.*)$/,"$1")||"-"},{header:()=>a("host"),accessorKey:T.Host,accessorFn:o=>`${o.metadata.host?o.metadata.host:o.metadata.destinationIP}:${o.metadata.destinationPort}`},{header:()=>a("sniffHost"),accessorKey:T.SniffHost,accessorFn:o=>o.metadata.sniffHost||"-"},{header:()=>a("rules"),accessorKey:T.Rule,accessorFn:o=>o.rulePayload?`${o.rule} :: ${o.rulePayload}`:o.rule},{header:()=>a("chains"),accessorKey:T.Chains,accessorFn:o=>o.chains.slice().reverse().join(" :: ")},{header:()=>a("connectTime"),enableGrouping:!1,accessorKey:T.ConnectTime,accessorFn:o=>Tt(o.start),sortingFn:(o,D)=>Fe(o.original.start).valueOf()-Fe(D.original.start).valueOf()},{header:()=>a("dlSpeed"),enableGrouping:!1,accessorKey:T.DlSpeed,accessorFn:o=>`${ue(o.downloadSpeed)}/s`,sortingFn:(o,D)=>o.original.downloadSpeed-D.original.downloadSpeed},{header:()=>a("ulSpeed"),enableGrouping:!1,accessorKey:T.ULSpeed,accessorFn:o=>`${ue(o.uploadSpeed)}/s`,sortingFn:(o,D)=>o.original.uploadSpeed-D.original.uploadSpeed},{header:()=>a("dl"),enableGrouping:!1,accessorKey:T.Download,accessorFn:o=>ue(o.download),sortingFn:(o,D)=>o.original.download-D.original.download},{header:()=>a("ul"),enableGrouping:!1,accessorKey:T.Upload,accessorFn:o=>ue(o.upload),sortingFn:(o,D)=>o.original.upload-D.original.upload},{header:()=>a("sourceIP"),accessorKey:T.SourceIP,accessorFn:o=>{const D=le().find(Z=>Z.sourceIP===o.metadata.sourceIP);return D?D.tagName:o.metadata.sourceIP}},{header:()=>a("sourcePort"),accessorKey:T.SourcePort,accessorFn:o=>o.metadata.sourcePort},{header:()=>a("destination"),accessorKey:T.Destination,accessorFn:o=>o.metadata.remoteDestination||o.metadata.destinationIP||o.metadata.host},{header:()=>a("inboundUser"),accessorKey:T.InboundUser,accessorFn:o=>o.metadata.inboundUser||o.metadata.inboundName||o.metadata.inboundPort}],[O,f]=W([]),[w,N]=ct(W([{id:T.ConnectTime,desc:!0}]),{name:"connectionsTableSorting",storage:localStorage}),M=Ct({filterFns:{fuzzy:Ne},state:{get columnOrder(){return Te()},get grouping(){return O()},get sorting(){return w()},get columnVisibility(){return Me()},get globalFilter(){return g()}},get data(){return i()===0?v():u()},sortDescFirst:!0,enableHiding:!0,columns:S,onGlobalFilterChange:$,globalFilterFn:Ne,onGroupingChange:f,onSortingChange:N,getFilteredRowModel:$t(),getSortedRowModel:St(),getExpandedRowModel:_t(),getGroupedRowModel:Dt(),getCoreRowModel:wt()}),A=M.getFlatHeaders().find(({id:o})=>o===T.SourceIP),[P,H]=W("");G(dt(P,()=>{const o=le().find(D=>D.sourceIP===P());A==null||A.column.setFilterValue(o?o.tagName:P())}));const te=q(()=>[{type:0,name:a("active"),count:v().length},{type:1,name:a("closed"),count:u().length}]);return(()=>{var o=lr(),D=o.firstChild,Z=D.firstChild,re=Z.firstChild,de=re.nextSibling,me=de.firstChild,n=Z.nextSibling,d=n.firstChild,m=D.nextSibling,k=m.firstChild,y=k.firstChild,I=y.nextSibling;return b(re,c($e,{get each(){return te()},children:s=>(()=>{var C=ir(),x=C.firstChild,R=x.nextSibling;return C.$$click=()=>p(s().type),b(x,()=>s().name),b(R,()=>s().count),B(()=>ae(C,se(i()===s().type&&"tab-active","tab-sm sm:tab-md tab gap-2"))),C})()})),de.addEventListener("change",s=>H(s.target.value)),b(me,()=>a("all")),b(de,c($e,{get each(){return He.uniq(De().map(({metadata:{sourceIP:s}})=>{const C=le().find(x=>x.sourceIP===s);return C?C.tagName:s})).sort()},children:s=>(()=>{var C=cr();return b(C,s),B(()=>C.value=s()),C})()}),null),d.$$input=s=>$(s.target.value),b(n,c(Y,{class:"join-item btn-sm sm:btn-md",onClick:()=>h(s=>!s),get icon(){return q(()=>!!l())()?c(ut,{}):c(gt,{})}}),null),b(n,c(Y,{class:"join-item btn-sm sm:btn-md",onClick:()=>{M.getState().globalFilter?M.getFilteredRowModel().rows.forEach(({original:s})=>Pe(s.id)):vt()},get icon(){return c(Ce,{})}}),null),b(n,c(Y,{class:"btn join-item btn-sm sm:btn-md",onClick:()=>r==null?void 0:r.showModal(),get icon(){return c(bt,{})}}),null),b(y,c(Q,{get each(){return M.getHeaderGroups()},children:s=>(()=>{var C=dr();return b(C,c(Q,{get each(){return s.headers},children:x=>(()=>{var R=ur(),K=R.firstChild,j=K.firstChild;return b(K,(()=>{var z=q(()=>!!x.column.getCanGroup());return()=>z()?(()=>{var U=gr();return pe(U,"click",x.column.getToggleGroupingHandler(),!0),b(U,(()=>{var J=q(()=>!!x.column.getIsGrouped());return()=>J()?c(Ae,{size:18}):c(Ee,{size:18})})()),U})():null})(),j),pe(j,"click",x.column.getToggleSortingHandler(),!0),b(j,()=>ge(x.column.columnDef.header,x.getContext())),b(K,()=>({asc:c(ft,{}),desc:c(mt,{})})[x.column.getIsSorted()]??null,null),B(z=>{var U=se("flex items-center gap-2"),J=se(x.column.getCanSort()&&"cursor-pointer select-none","flex-1");return U!==z.e&&ae(K,z.e=U),J!==z.t&&ae(j,z.t=J),z},{e:void 0,t:void 0}),R})()})),C})()})),b(I,c(Q,{get each(){return M.getRowModel().rows},children:s=>(()=>{var C=vr();return b(C,c(Q,{get each(){return s.getVisibleCells()},children:x=>(()=>{var R=br();return R.$$contextmenu=K=>{K.preventDefault();const j=x.renderValue();j&&sr(j).catch(()=>{})},b(R,(()=>{var K=q(()=>!!x.getIsGrouped());return()=>K()?(()=>{var j=fr(),z=j.firstChild,U=z.nextSibling,J=U.nextSibling,Ye=J.firstChild,Oe=Ye.nextSibling;return Oe.nextSibling,pe(j,"click",s.getToggleExpandedHandler(),!0),b(z,(()=>{var Xe=q(()=>!!s.getIsExpanded());return()=>Xe()?c(Ae,{size:18}):c(Ee,{size:18})})()),b(U,()=>ge(x.column.columnDef.cell,x.getContext())),b(J,()=>s.subRows.length,Oe),B(()=>ae(j,se(s.getCanExpand()?"cursor-pointer":"cursor-normal","flex items-center gap-2"))),j})():(()=>{var j=q(()=>!!x.getIsAggregated());return()=>j()?ge(x.column.columnDef.aggregatedCell??x.column.columnDef.cell,x.getContext()):(()=>{var z=q(()=>!!x.getIsPlaceholder());return()=>z()?null:ge(x.column.columnDef.cell,x.getContext())})()})()})()),R})()})),C})()})),b(o,c(ar,{ref:s=>r=s,get order(){return Te()},get visible(){return Me()},onOrderChange:s=>pt(s),onVisibleChange:s=>ht({...s})}),null),b(o,c(or,{ref:s=>e=s,get selectedConnectionID(){return _()}}),null),B(s=>{var C=a("search"),x=se(yt(qe()),"table table-zebra relative rounded-none");return C!==s.e&&xt(d,"placeholder",s.e=C),x!==s.t&&ae(k,s.t=x),s},{e:void 0,t:void 0}),o})()};It(["input","click","contextmenu"]);export{Cr as default};
