import{b as Z,v as se,u as R,w as M,o as ie,b7 as ce,i as e,d as l,b8 as O,S as T,t as v,b9 as oe,c as J,B as D,F as N,ba as de,p as Y,bb as x,af as ue,K as u,an as B,bc as ge,bd as be,be as pe,bf as he,bg as ve,bh as fe,bi as me,bj as xe,bk as _e,bl as $e,bm as Ce,bn as ke,bo as U,bp as X,bq as ye,br as Se,b6 as we,h as Ee,bs as Ie,bt as De,bu as K,bv as Te,bw as W,bx as Ae,by as Le,bz as Pe,bA as Ne,bB as Fe,f as Be,bC as Re}from"./index-o5lPLXoZ.js";import{z as S,c as ee,v as le}from"./index-DLW1Uto8.js";import{C as w}from"./ConfigTitle-Ct7fRULr.js";var Ue=v('<div class="flex flex-col p-4">'),je=v('<div class="flex flex-col"><form class="flex gap-2 sm:flex-row"><input type=search name=name class="input input-bordered min-w-0 flex-1"placeholder=google.com><div class="flex items-center gap-2"><select name=type class="select select-bordered"><option>A</option><option>AAAA</option><option>MX'),Oe=v("<div class=py-2>"),Me=v('<form class="grid grid-cols-3 gap-2 sm:grid-cols-5">'),Qe=v('<div class="grid grid-cols-2 gap-2 sm:grid-cols-4"><div class=form-control><label for=enable-allow-lan class="label gap-2"><span class=label-text></span></label><input id=enable-allow-lan type=checkbox class=toggle></div><div class=form-control><label for=enable-tun-device class="label gap-2"><span class=label-text></span></label><input id=enable-tun-device type=checkbox class=toggle></div><div class=form-control><label for=tun-ip-stack class="label gap-2"><span class=label-text></span></label><select id=tun-ip-stack class="select select-bordered flex-1"><option>Mixed</option><option>gVisor</option><option>System</option><option>LWIP</option></select></div><div class=form-control><label for=device-name class="label gap-2"><span class=label-text></span></label><input id=device-name class="input input-bordered min-w-0"></div><div class=form-control><label for=interface-name class="label gap-2"><span class=label-text></span></label><input id=interface-name class="input input-bordered min-w-0">'),Ge=v('<div class="flex flex-col gap-4"><select class="select select-bordered"><option></option><option></option><option></option></select><div class="grid grid-cols-2 gap-2 sm:grid-cols-3">'),qe=v('<div class=form-control><label class=label><span class=label-text></span></label><input type=number class="input input-bordered">'),Ve=v('<div class="flex flex-col gap-2"><div class="flex flex-col"><select class="select select-bordered"></select></div><div class="flex flex-col"><select class="select select-bordered">'),ze=v('<div class="grid grid-cols-1 gap-4 sm:grid-cols-2"><div class="flex flex-col gap-2"><div class="flex flex-col items-center"><input type=checkbox class=toggle></div><div class="flex flex-col"><select class="select select-bordered"></select></div><div class="flex flex-col"><div class="py-2 text-center text-lg font-semibold">&nbsp;</div></div></div><div class="flex flex-col gap-2"><div class="flex flex-col items-center"><input type=checkbox class=toggle>'),j=v("<option>"),He=v('<span class="absolute -right-1 -top-1 flex h-3 w-3"><span class="absolute inline-flex h-full w-full animate-ping rounded-full bg-info opacity-75"></span><span class="inline-flex h-3 w-3 rounded-full bg-info">'),Xe=v('<div class="grid grid-cols-2 gap-4"><kbd class=kbd></kbd><div class=relative><kbd class="kbd w-full">'),Ke=v('<div class="mx-auto flex max-w-screen-md flex-col gap-4">');const We=S.object({name:S.string(),type:S.string()}),Ze=()=>{const[o]=R(),t=oe(),{form:f,isSubmitting:g}=ee({extend:le({schema:We}),onSubmit:s=>t.get("dns/query",{searchParams:{name:s.name,type:s.type}}).json().then(({Answer:a})=>_((a==null?void 0:a.map(({data:n})=>n))||[])).catch(a=>Be.error(a.message))}),[c,_]=M([]);return(()=>{var s=je(),a=s.firstChild,n=a.firstChild,$=n.nextSibling;return $.firstChild,J(f,a,()=>f),e($,l(D,{type:"submit",class:"btn-primary",get loading(){return g()},get children(){return o("dnsQuery")}}),null),e(s,l(T,{get when(){return c().length>0},get children(){var k=Ue();return e(k,l(N,{get each(){return c()},children:E=>(()=>{var y=Oe();return e(y,E),y})()})),k}}),null),s})()},Je=S.object({port:S.number(),"socks-port":S.number(),"redir-port":S.number(),"tproxy-port":S.number(),"mixed-port":S.number()}),Ye=({backendVersion:o})=>{const[t]=R(),f=[{label:()=>t("port",{name:"Mixed"}),key:"mixed-port",onChange:n=>void x("mixed-port",Number(n.target.value),a)},{label:()=>t("port",{name:"HTTP"}),key:"port",onChange:n=>void x("port",Number(n.target.value),a)},{label:()=>t("port",{name:"Socks"}),key:"socks-port",onChange:n=>void x("socks-port",Number(n.target.value),a)},{label:()=>t("port",{name:"Redir"}),key:"redir-port",onChange:n=>void x("redir-port",Number(n.target.value),a)},{label:()=>t("port",{name:"TProxy"}),key:"tproxy-port",onChange:n=>void x("tproxy-port",Number(n.target.value),a)}],{form:g,setInitialValues:c,reset:_}=ee({extend:le({schema:Je})}),[s,{refetch:a}]=de(Re);return Y(()=>{const n=s();n&&(c(n),_())}),(()=>{var n=Ge(),$=n.firstChild,k=$.firstChild,E=k.nextSibling,y=E.nextSibling,d=$.nextSibling;return $.addEventListener("change",i=>void x("mode",i.target.value,a)),e(k,()=>t("global")),e(E,()=>t("rule")),e(y,()=>t("direct")),e(n,l(T,{get when(){return!O(o())},get children(){return[(()=>{var i=Me();return J(g,i,()=>g),e(i,l(N,{each:f,children:p=>(()=>{var I=qe(),C=I.firstChild,h=C.firstChild,b=C.nextSibling;return e(h,()=>p.label()),ue(b,"change",p.onChange),u(m=>{var F=p.key,A=p.key,L=p.key,P=p.label();return F!==m.e&&B(C,"for",m.e=F),A!==m.t&&B(b,"id",m.t=A),L!==m.a&&B(b,"name",m.a=L),P!==m.o&&B(b,"placeholder",m.o=P),m},{e:void 0,t:void 0,a:void 0,o:void 0}),I})()})),i})(),(()=>{var i=Qe(),p=i.firstChild,I=p.firstChild,C=I.firstChild,h=I.nextSibling,b=p.nextSibling,m=b.firstChild,F=m.firstChild,A=m.nextSibling,L=b.nextSibling,P=L.firstChild,te=P.firstChild,Q=P.nextSibling,G=L.nextSibling,q=G.firstChild,ae=q.firstChild,V=q.nextSibling,ne=G.nextSibling,z=ne.firstChild,re=z.firstChild,H=z.nextSibling;return e(C,()=>t("allowLan")),h.addEventListener("change",r=>void x("allow-lan",r.target.checked,a)),e(F,()=>t("enableTunDevice")),A.addEventListener("change",r=>void x("tun",{enable:r.target.checked},a)),e(te,()=>t("tunModeStack")),Q.addEventListener("change",r=>void x("tun",{stack:r.target.value},a)),e(ae,()=>t("tunDeviceName")),V.addEventListener("change",r=>void x("tun",{device:r.target.value},a)),e(re,()=>t("interfaceName")),H.addEventListener("change",r=>void x("interface-name",r.target.value,a)),u(()=>{var r;return h.checked=(r=s())==null?void 0:r["allow-lan"]}),u(()=>{var r;return A.checked=(r=s())==null?void 0:r.tun.enable}),u(()=>{var r;return Q.value=(r=s())==null?void 0:r.tun.stack}),u(()=>{var r;return V.value=(r=s())==null?void 0:r.tun.device}),u(()=>{var r;return H.value=(r=s())==null?void 0:r["interface-name"]}),i})()]}}),d),e(d,l(D,{class:"btn-primary",get loading(){return ge()},onClick:be,get children(){return t("reloadConfig")}}),null),e(d,l(D,{class:"btn-accent",get loading(){return pe()},onClick:he,get children(){return t("flushFakeIP")}}),null),e(d,l(D,{class:"btn-warning",get loading(){return ve()},onClick:fe,get children(){return t("restartCore")}}),null),e(d,l(T,{get when(){return!O(o())},get children(){return[l(D,{class:"btn-secondary",get loading(){return me()},onClick:xe,get children(){return t("updateGEODatabases")}}),l(D,{class:"btn-info",get loading(){return _e()},onClick:$e,get children(){return t("upgradeUI")}}),l(D,{class:"btn-error",get loading(){return Ce()},onClick:ke,get children(){return t("upgradeCore")}})]}}),null),u(()=>{var i;return $.value=(i=s())==null?void 0:i.mode}),u(()=>k.value=U.Global),u(()=>E.value=U.Rule),u(()=>y.value=U.Direct),n})()},el=()=>{const[o]=R(),t=Z(),f=[{label:()=>o("en"),value:X.EN},{label:()=>o("zh"),value:X.ZH}];return(()=>{var g=ze(),c=g.firstChild,_=c.firstChild,s=_.firstChild,a=_.nextSibling,n=a.firstChild,$=a.nextSibling;$.firstChild;var k=c.nextSibling,E=k.firstChild,y=E.firstChild;return e(_,l(w,{get children(){return o("useTwemoji")}}),s),s.addEventListener("change",d=>ye(d.target.checked)),e(a,l(w,{get children(){return o("switchLanguage")}}),n),n.addEventListener("change",d=>Se(d.target.value)),e(n,l(N,{each:f,children:d=>(()=>{var i=j();return e(i,()=>d.label()),u(()=>i.selected=we()===d.value),u(()=>i.value=d.value),i})()})),e($,l(D,{class:"btn-info",onClick:()=>{Ee(""),t(Ie.Setup)},get children(){return o("switchEndpoint")}}),null),e(E,l(w,{get children(){return o("autoSwitchTheme")}}),y),y.addEventListener("change",d=>De(d.target.checked)),e(k,l(T,{get when(){return K()},get children(){var d=Ve(),i=d.firstChild,p=i.firstChild,I=i.nextSibling,C=I.firstChild;return e(i,l(w,{get children(){return o("favDayTheme")}}),p),p.addEventListener("change",h=>Te(h.target.value)),e(p,l(N,{each:W,children:h=>(()=>{var b=j();return b.value=h,e(b,h),b})()})),e(I,l(w,{get children(){return o("favNightTheme")}}),C),C.addEventListener("change",h=>Ae(h.target.value)),e(C,l(N,{each:W,children:h=>(()=>{var b=j();return b.value=h,e(b,h),b})()})),u(()=>p.value=Le()),u(()=>C.value=Pe()),d}}),null),u(()=>s.checked=Ne()),u(()=>y.checked=K()),g})()},ll=({backendVersion:o})=>{const[t,f]=M(!1);return Y(async()=>{const g=o();g&&f(await Fe(g))}),(()=>{var g=Xe(),c=g.firstChild,_=c.nextSibling,s=_.firstChild;return e(c,()=>"1.141.1"),e(_,l(T,{get when(){return t()},get children(){return He()}}),s),e(s,o),g})()},rl=()=>{const o=Z();if(!se())return o("/setup",{replace:!0}),null;const[t]=R(),[f,g]=M("");return ie(async()=>{g(await ce())}),(()=>{var c=Ke();return e(c,l(T,{get when(){return!O(f())},get children(){return[l(w,{withDivider:!0,get children(){return t("dnsQuery")}}),l(Ze,{})]}}),null),e(c,l(w,{withDivider:!0,get children(){return t("coreConfig")}}),null),e(c,l(Ye,{backendVersion:f}),null),e(c,l(w,{withDivider:!0,get children(){return t("xdConfig")}}),null),e(c,l(el,{}),null),e(c,l(w,{withDivider:!0,get children(){return t("version")}}),null),e(c,l(ll,{backendVersion:f}),null),c})()};export{rl as default};
